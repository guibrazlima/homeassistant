# üè† Sistema Home Assistant - Documenta√ß√£o Completa

## üìã √çndice
1. [Vis√£o Geral](#-vis√£o-geral)
2. [Arquitetura do Sistema](#-arquitetura-do-sistema)
3. [Componentes Principais](#-componentes-principais)
4. [Integra√ß√µes Personalizadas](#-integra√ß√µes-personalizadas)
5. [Automa√ß√µes](#-automa√ß√µes)
6. [Configura√ß√£o de Rede](#-configura√ß√£o-de-rede)
7. [Monitoriza√ß√£o e Logging](#-monitoriza√ß√£o-e-logging)
8. [Backups](#-backups)
9. [Manuten√ß√£o](#-manuten√ß√£o)
10. [Seguran√ßa](#-seguran√ßa)

## üîç Vis√£o Geral

Este √© um sistema Home Assistant completo e avan√ßado que implementa uma solu√ß√£o de dom√≥tica integrada para automa√ß√£o residencial. O sistema inclui controlo de energia solar, gest√£o de humidade, automa√ß√µes inteligentes e monitoriza√ß√£o completa da casa.

### üìä Estat√≠sticas do Sistema
- **Data de √öltima Atualiza√ß√£o**: Julho 2025
- **Vers√£o HA**: 2023.1+
- **Automa√ß√µes Ativas**: 2500+ linhas
- **Componentes Personalizados**: 24+ integra√ß√µes
- **Sensores**: 100+ entidades monitorizadas

## üèó Arquitetura do Sistema

### üîó Componentes Base
```yaml
# Configura√ß√£o principal (configuration.yaml)
default_config:          # Configura√ß√£o padr√£o do HA
recorder:                # Base de dados MariaDB
history:                 # Hist√≥rico de entidades
influxdb:               # Base de dados para m√©tricas
logger:                 # Sistema de logging
```

### üì° Conectividade
- **Base de Dados**: MariaDB (externa)
- **M√©tricas**: InfluxDB v2
- **Proxy Reverso**: Nginx (172.0.0.0/8, 192.168.1.221/32, 192.168.1.222/32)
- **Notifica√ß√µes**: Telegram Bot

## üß© Componentes Principais

### üîã Sistema de Energia Solar
**PV Excess Control** - Controlo autom√°tico de excesso de energia solar
- **Localiza√ß√£o**: `pv_excess_control.yaml`, `pyscript/pv_excess_control.py`
- **Funcionalidades**:
  - Gest√£o autom√°tica de aparelhos baseada no excesso de energia solar
  - Suporte para inversores h√≠bridos e standard
  - Controlo din√¢mico de corrente (wallboxes)
  - Sistema de prioridades configur√°vel
  - Integra√ß√£o com previs√µes Solcast
  - Suporte mono e trif√°sico

**Configura√ß√£o T√≠pica**:
```yaml
automation_id: automation.pv_excess_wallbox
appliance_priority: 100
grid_voltage: 230
min_home_battery_level: 20
```

### üå°Ô∏è Controlo de Humidade Otimizada
**Optimal Humidity** - Sensor inteligente de humidade
- **Localiza√ß√£o**: `custom_components/optimal_humidity/`
- **Funcionalidades**:
  - C√°lculo autom√°tico da humidade ideal
  - Preven√ß√£o de condensa√ß√£o e mofo
  - √çndice de conforto Humidex
  - Monitoriza√ß√£o de ponto de orvalho
  - Alertas de risco de mofo

**Sensores Dispon√≠veis**:
- `dewpoint` - Ponto de orvalho
- `specific_humidity` - Humidade espec√≠fica
- `optimal_humidity` - Humidade ideal
- `mold_warning` - Alerta de mofo
- `humidex` - √çndice Humidex

### üö™ Sistema de Port√µes e Acessos
```yaml
# Automa√ß√£o de port√£o com callback
- alias: "üè° Callback to open gate from action"
  trigger:
    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: ABRIR_PORTAO
  action:
    - service: cover.open_cover
      target:
        entity_id: cover.gate
```

## üîß Integra√ß√µes Personalizadas

### üì¶ Componentes Instalados via HACS
O sistema utiliza 24+ integra√ß√µes personalizadas para funcionalidades avan√ßadas:

#### üö® **alarmo** - Sistema de Alarmes
- **Fun√ß√£o**: Sistema completo de alarmes residenciais
- **Caracter√≠sticas**: M√∫ltiplas zonas, c√≥digos de utilizador, notifica√ß√µes
- **Integra√ß√£o**: Sensores de movimento, contactos de porta/janela

#### üîÑ **auto_backup** - Backups Autom√°ticos  
- **Fun√ß√£o**: Gest√£o autom√°tica de backups do sistema
- **Scheduling**: Backups di√°rios √†s 01:00 e de hora a hora
- **Reten√ß√£o**: Limpeza autom√°tica de backups antigos
- **Formato**: TAR comprimido com timestamp

#### üì∂ **ble_monitor** - Monitor Bluetooth LE
- **Fun√ß√£o**: Monitoriza√ß√£o de dispositivos Bluetooth Low Energy
- **Sensores**: BTHome (temperatura, humidade, movimento)
- **Alcance**: Cobertura completa da habita√ß√£o
- **Protocolo**: BTHome v2 para m√°xima compatibilidade

#### üåê **browser_mod** - Controlo do Navegador
- **Fun√ß√£o**: Controlo avan√ßado do navegador para dashboards
- **Caracter√≠sticas**: Pop-ups din√¢micos, navega√ß√£o autom√°tica
- **Media Player**: Controlo de reprodu√ß√£o de media
- **Notification**: Notifica√ß√µes no navegador

#### ‚ö° **entsoe** - Dados Energ√©ticos Europeus
- **Fun√ß√£o**: Acesso a dados energ√©ticos em tempo real da Europa
- **API**: ENTSO-E Transparency Platform
- **Dados**: Pre√ßos spot, produ√ß√£o renov√°vel, consumo
- **Regi√£o**: Portugal/Pen√≠nsula Ib√©rica

#### üöó **ev_smart_charging** - Carregamento Inteligente VE
- **Fun√ß√£o**: Otimiza√ß√£o de carregamento de ve√≠culos el√©tricos
- **Algoritmos**: Baseado em pre√ßos energ√©ticos e produ√ß√£o solar
- **Suporte**: OCPP, wallboxes Tesla, outros protocolos
- **Scheduling**: Carregamento em hor√°rios de menor custo

#### üè™ **hacs** - Home Assistant Community Store
- **Fun√ß√£o**: Loja de componentes da comunidade
- **Reposit√≥rios**: 1000+ integra√ß√µes dispon√≠veis
- **Atualiza√ß√µes**: Gest√£o autom√°tica de vers√µes
- **Backup**: Restaura√ß√£o de configura√ß√µes

#### üå°Ô∏è **midea_ac** + **midea_dehumidifier_lan** 
- **Fun√ß√£o**: Controlo de equipamentos Midea via LAN
- **Dispositivos**: Ares condicionados, desumidificadores
- **Protocolo**: Comunica√ß√£o direta sem cloud
- **Funcionalidades**: Temperatura, modo, velocidade, timer

#### üîå **ocpp** - Open Charge Point Protocol
- **Fun√ß√£o**: Protocolo standard para wallboxes
- **Compatibilidade**: Wallboxes comerciais e DIY
- **Monitoriza√ß√£o**: Energia, estado de carregamento, erros
- **Controlo**: Start/stop, limite de corrente, scheduling

#### üí∞ **omie** - Mercado Energ√©tico Ib√©rico
- **Fun√ß√£o**: Pre√ßos spot do mercado OMIE em tempo real
- **Frequ√™ncia**: Atualiza√ß√£o hor√°ria
- **Dados**: Pre√ßos PT/ES, previs√µes, hist√≥rico
- **Integra√ß√£o**: Templates de tarif√°rios din√¢micos

#### üß† **powerbrain** - Gest√£o Inteligente de Energia
- **Fun√ß√£o**: Otimiza√ß√£o autom√°tica do consumo energ√©tico
- **IA**: Algoritmos de machine learning para padr√µes
- **Previs√µes**: Consumo futuro baseado em hist√≥rico
- **Controlo**: Gest√£o autom√°tica de cargas

#### üêç **pyscript** - Scripts Python Avan√ßados
- **Fun√ß√£o**: Execu√ß√£o de c√≥digo Python nativo no HA
- **Caracter√≠sticas**: 
  - Triggers temporais e de estado
  - Acesso completo √† API do HA
  - Bibliotecas Python externas
- **Scripts Ativos**:
  - `pv_excess_control.py` - Controlo de excesso solar
  - Scripts de c√°lculo energ√©tico
  - Automa√ß√µes complexas

#### ‚òÄÔ∏è **solcast_solar** - Previs√µes Solares
- **Fun√ß√£o**: Previs√µes precisas de produ√ß√£o solar
- **API**: Solcast.com.au com dados meteorol√≥gicos
- **Dados**: Produ√ß√£o estimada, irradia√ß√£o, cobertura nuvens
- **Ficheiros de Configura√ß√£o**:
  ```json
  // solcast-sites.json
  {
    "sites": [
      {
        "resource_id": "xxxxx-xxxx-xxxx",
        "capacity": 10.0,
        "tilt": 30,
        "azimuth": 180
      }
    ]
  }
  ```

#### üîå **tapo_control** - Dispositivos TP-Link Tapo
- **Fun√ß√£o**: Controlo de dispositivos Tapo (plugs, c√¢maras, l√¢mpadas)
- **Protocolo**: Comunica√ß√£o local sem cloud
- **Monitoriza√ß√£o**: Consumo energ√©tico, estado, programa√ß√£o
- **Automa√ß√£o**: Integra√ß√£o completa com automa√ß√µes HA

#### üå°Ô∏è **thermal_comfort** - Conforto T√©rmico
- **Fun√ß√£o**: C√°lculos avan√ßados de conforto t√©rmico
- **M√©tricas**: 
  - Heat Index
  - Simmer Index  
  - Frost Point
  - Thermal Perception
- **Sensores**: Baseado em temperatura e humidade existentes

#### üíª **ui_lovelace_minimalist** - Interface Minimalista
- **Fun√ß√£o**: Framework de UI moderna e minimalista
- **Caracter√≠sticas**:
  - Design cards personalizadas
  - Temas adaptativos
  - Performance otimizada
- **Localiza√ß√£o**: `ui_lovelace_minimalist/`, `button_card_templates/`

#### üìä **variable** - Vari√°veis Persistentes
- **Fun√ß√£o**: Cria√ß√£o de vari√°veis que persistem entre rein√≠cios
- **Casos de Uso**: Contadores, estados tempor√°rios, configura√ß√µes
- **API**: Servi√ßos para set/get de valores
- **Backup**: Inclu√≠do nos backups autom√°ticos

#### üå™Ô∏è **xiaomi_miio** - Dispositivos Xiaomi
- **Fun√ß√£o**: Integra√ß√£o com ecosistema Xiaomi/Mijia
- **Dispositivos**: Ventoinhas, purificadores ar, robots aspirador
- **Protocolos**: miIO protocol, raw commands
- **Controlo**: Speed, oscila√ß√£o, timer, modo

### üéØ Configura√ß√µes Espec√≠ficas Avan√ßadas

#### üìä InfluxDB v2 - Base de Dados de M√©tricas
```yaml
influxdb:
  api_version: 2
  ssl: false
  host: influxdb
  port: 8086
  token: !secret influxdb_token
  organization: gl
  bucket: homeassistant
  tags:
    source: HomeAssistant
    installation: production
  tags_attributes:
    - friendly_name
    - device_class
  default_measurement: units
  ignore_attributes:
    - icon
    - entity_picture
  exclude:
    entities:
      - zone.home
      - sun.sun
    domains:
      - persistent_notification
      - person
      - weather
  include:
    entities:
      - sensor.emoncms_*
      - sensor.solcast_*
      - sensor.*_energy_*
```

**Caracter√≠sticas**:
- **Organiza√ß√£o**: Dados estruturados por tags
- **Performance**: Queries otimizadas para dashboards
- **Reten√ß√£o**: Pol√≠ticas de reten√ß√£o autom√°ticas
- **Grafana**: Integra√ß√£o para visualiza√ß√µes avan√ßadas

#### üîÑ MariaDB - Recorder Principal
```yaml
recorder:
  db_url: !secret mariadb_connection
  auto_purge: false
  commit_interval: 5
  include:
    domains:
      - sensor
      - switch
      - light
      - climate
      - cover
  exclude:
    entity_globs:
      - sensor.*_last_*
      - sensor.*_next_*
    entities:
      - sensor.time
      - sensor.date
```

**Otimiza√ß√µes**:
- **√çndices**: Criados automaticamente para queries frequentes
- **Purga Manual**: Controlo fino sobre limpeza de dados
- **Particionamento**: Tabelas particionadas por data
- **Backup**: Dump di√°rio para backup/restore

## ü§ñ Automa√ß√µes

### üìä Estat√≠sticas das Automa√ß√µes
- **Total de Automa√ß√µes**: Ficheiro com 2500+ linhas
- **Triggers Ativos**: Time-based, State-based, Event-based
- **Complexidade**: Desde simples ON/OFF at√© l√≥gica multi-condicional
- **Categorias Principais**:
  - üåû **Gest√£o de energia solar** (PV Excess Control)
  - üèä **Controlo de piscina** (Manual/Autom√°tico)
  - üí° **Ilumina√ß√£o inteligente** (Presen√ßa + Tempo)
  - üöó **Carregamento de ve√≠culos el√©tricos** (Hor√°rio otimizado)
  - üå°Ô∏è **Controlo de clima** (Bomba de calor + aquecimento)
  - üîî **Notifica√ß√µes** (Telegram + Mobile app)
  - üö™ **Controlo de acessos** (Port√µes + seguran√ßa)
  - ‚ö° **Monitoriza√ß√£o de rede** (Speedtests + conectividade)

### üèä Sistema de Piscina Avan√ßado
Sistema completo de gest√£o de piscina com m√∫ltiplos modos de opera√ß√£o:

```yaml
# Script principal para alternar modo autom√°tico/manual
alternar_modo_automacao_piscina:
  alias: "Alternar Entre Modo Piscina Manual e Autom√°tico"
  sequence:
    - choose:
        # Modo Autom√°tico ‚Üí Manual
        - conditions:
            - condition: state
              entity_id: input_boolean.modo_automatico
              state: 'on'
          sequence:
            - service: input_boolean.turn_off
              target:
                entity_id: input_boolean.modo_automatico
            - service: automation.turn_off
              target:
                entity_id:
                  - automation.automacao_bomba_piscina
                  - automation.bomba_piscina_noite
            - service: persistent_notification.create
              data:
                message: "Modo Manual ativado. Automa√ß√µes desativadas."
                title: "Altera√ß√£o de Modo"
        
        # Modo Manual ‚Üí Autom√°tico  
        - conditions:
            - condition: state
              entity_id: input_boolean.modo_automatico
              state: 'off'
          sequence:
            - service: input_boolean.turn_on
              target:
                entity_id: input_boolean.modo_automatico
            - service: automation.turn_on
              target:
                entity_id:
                  - automation.automacao_bomba_piscina
                  - automation.bomba_piscina_noite
            - service: persistent_notification.create
              data:
                message: "Modo Autom√°tico ativado. Automa√ß√µes ativadas."
                title: "Altera√ß√£o de Modo"
```

**Funcionalidades da Piscina**:
- **Modo Manual**: Controlo direto pelo utilizador
- **Modo Autom√°tico**: Baseado em temperatura, tempo de filtragem e condi√ß√µes meteorol√≥gicas
- **Scheduling**: Bomba noturna com hor√°rios otimizados
- **Feedback**: Notifica√ß√µes de mudan√ßa de estado
- **Templates**: C√°lculo de tempo restante e dura√ß√£o de filtragem

### ‚ö° Monitoriza√ß√£o de Rede
Sistema automatizado de testes de velocidade de internet:

```yaml
- alias: SpeedTests
  description: 'Testes autom√°ticos de velocidade de internet'
  trigger:
    - platform: time
      at: 06:30:00       # Teste matinal
    - platform: time
      at: '18:30:00'     # Teste vespertino
    - event: sunrise
      offset: -00:35:00  # Teste ao nascer do sol
  condition: []
  action:
    - service: homeassistant.update_entity
      data: {}
      target:
        entity_id: sensor.speedtest_download
  mode: single
```

**Caracter√≠sticas**:
- **Frequ√™ncia**: 3x por dia em hor√°rios estrat√©gicos
- **M√©tricas**: Download, upload, ping e jitter
- **Hist√≥rico**: Armazenamento em InfluxDB para an√°lise de tend√™ncias
- **Alertas**: Notifica√ß√£o se velocidade abaixo do esperado

### üö™ Sistema de Port√µes Inteligente
Controlo de acessos com notifica√ß√µes m√≥veis:

```yaml
# Callback para abrir port√£o via notifica√ß√£o m√≥vel
- alias: "üè° Callback to open gate from action"
  description: 'Abertura remota via notification action'
  trigger:
    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: ABRIR_PORTAO
  condition: []
  action:
    - service: cover.open_cover
      data: {}
      target:
        entity_id:
          - cover.gate
  mode: restart

# Ilumina√ß√£o autom√°tica da garagem
- alias: "üí°üè° Garage light on when gate opens/closes"
  description: 'Ativa√ß√£o autom√°tica da luz da garagem'
  trigger:
    - platform: state
      entity_id:
        - cover.gate
      from: closed
      to: open
      for:
        hours: 0
        minutes: 0
        seconds: 2
    - platform: state
      entity_id:
        - cover.gate
      from: open
      to: closed
  action:
    - service: light.turn_on
      target:
        entity_id: light.garage
    - delay: '00:05:00'    # Luz ligada por 5 minutos
    - service: light.turn_off
      target:
        entity_id: light.garage
```

**Seguran√ßa e Controlo**:
- **Acesso Remoto**: Via app m√≥vel com a√ß√µes de notifica√ß√£o
- **Ilumina√ß√£o Autom√°tica**: Luz da garagem ao abrir/fechar port√£o
- **Logs**: Registo de todas as opera√ß√µes
- **Timeout**: Desativa√ß√£o autom√°tica da ilumina√ß√£o

### üåû Gest√£o Solar Avan√ßada
Sistema PV Excess Control integrado nas automa√ß√µes:

```yaml
# Exemplo de automa√ß√£o solar (configura√ß√£o via blueprint)
automation_pv_wallbox:
  alias: "Solar Excess - Wallbox Charging"
  use_blueprint:
    path: pv_excess_control.yaml
    input:
      automation_id: automation.pv_excess_wallbox
      appliance_priority: 100
      pv_power: sensor.solcast_pv_power
      export_power: sensor.emoncms_export
      appliance_switch: switch.wallbox_charging
      min_current: 6
      max_current: 32
      grid_voltage: 230
```

**Automa√ß√µes Solares Ativas**:
- **Wallbox**: Carregamento autom√°tico durante excesso solar
- **Bomba de Calor**: Aquecimento de √°gua quando h√° excedente
- **Piscina**: Filtragem adicional com energia solar gratuita
- **Electrodom√©sticos**: Ativa√ß√£o inteligente (m√°quina de lavar, etc.)

### üå°Ô∏è Controlo Clim√°tico Inteligente
Automa√ß√µes para efici√™ncia energ√©tica:

```yaml
# Otimiza√ß√£o de aquecimento baseada em pre√ßos
- alias: "Heat Pump Night Mode"
  trigger:
    - platform: template
      value_template: "{{ states('sensor.aquecimento_agua_noite') == now().strftime('%H:%M') }}"
  action:
    - service: climate.set_temperature
      target:
        entity_id: climate.hpsu_can
      data:
        temperature: 55
    - service: notify.telegram
      data:
        message: "Aquecimento de √°gua ativado na hora mais barata: {{ states('sensor.aquecimento_agua_noite') }}"
```

### üîî Sistema de Notifica√ß√µes
Telegram Bot integrado para alertas em tempo real:

```yaml
# Configura√ß√£o do bot
telegram_bot:
  - platform: polling
    api_key: !secret telegram_bot_api_key
    allowed_chat_ids:
      - 5258104860  # Utilizador autorizado

# Notifica√ß√µes autom√°ticas
notify:
  - platform: telegram
    name: "Gui"
    chat_id: 45258104860
```

**Tipos de Notifica√ß√µes**:
- **Energia**: Excesso solar, pre√ßos baixos, falhas de rede
- **Seguran√ßa**: Abertura de port√µes, movimento detectado
- **Sistema**: Backups completados, atualiza√ß√µes dispon√≠veis
- **Manuten√ß√£o**: Limpeza de filtros, verifica√ß√µes peri√≥dicas

### üì± Presen√ßa Inteligente
Sistema de detec√ß√£o de presen√ßa via HomeKit:

```yaml
# Sensores de presen√ßa via input_boolean
binary_sensor:
  - platform: template
    sensors:
      hk_presence_gblima:
        friendly_name: "gblima(HK)"
        device_class: presence
        value_template: >-
          {{ is_state('input_boolean.gblima_present', 'on') }}
      hk_presence_cmouta:
        friendly_name: "cmouta(HK)"
        device_class: presence
        value_template: >-
          {{ is_state('input_boolean.cmouta_present', 'on') }}
```

**Automa√ß√µes baseadas em Presen√ßa**:
- **Ilumina√ß√£o**: Auto ON/OFF baseado na presen√ßa
- **Clima**: Ajuste de temperatura quando ningu√©m est√° em casa
- **Seguran√ßa**: Ativa√ß√£o de alarmes quando todos saem
- **Energia**: Modo poupan√ßa autom√°tico

## üåê Configura√ß√£o de Rede

### üîí Proxy Reverso
```yaml
http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 172.0.0.0/8
    - 192.168.1.221/32
    - 192.168.1.222/32
```

### üîê Autentica√ß√£o
- Suporte para headers de autentica√ß√£o externa
- Integra√ß√£o com sistemas SSO (comentado)

## üìä Monitoriza√ß√£o e Logging

### üìà Sistema de M√©tricas
- **InfluxDB**: Armazenamento de m√©tricas de longo prazo
- **Recorder**: Base de dados MariaDB para hist√≥rico
- **History**: Componente de hist√≥rico nativo

### üìù Configura√ß√£o de Logging
```yaml
logger:
  default: info
  logs:
    custom_components.pyscript.file.pv_excess_control: INFO
    custom_components.auth_header: debug
```

### üè∑Ô∏è Tags InfluxDB
```yaml
tags:
  source: HomeAssistant
tags_attributes:
  - friendly_name
exclude:
  entities:
    - zone.home
  domains:
    - persistent_notification
    - person
```

## üíæ Backups

### üìÖ Sistema de Backup Autom√°tico
O sistema possui backups autom√°ticos organizados em:

#### üîÑ Backups Di√°rios
- **Localiza√ß√£o**: `backups/DailyBackup*`
- **Frequ√™ncia**: Di√°ria √†s 01:00
- **Reten√ß√£o**: M√∫ltiplos dias guardados
- **Formato**: TAR comprimido

#### ‚è∞ Backups de Hora a Hora
- **Localiza√ß√£o**: `backups/HourlyBackup*`
- **Frequ√™ncia**: 12:00 AM e 12:00 PM
- **Casos de Uso**: Recupera√ß√£o r√°pida de altera√ß√µes recentes

### üìÅ Estrutura de Backups
```
backups/
‚îú‚îÄ‚îÄ DailyBackup_Friday_February_7_2025_2025-02-07_01.00_00258324.tar
‚îú‚îÄ‚îÄ DailyBackup_Saturday_February_8_2025_2025-02-08_01.00_00396380.tar
‚îú‚îÄ‚îÄ HourlyBackup_Friday_12:00_AM_February_7_2025_2025-02-07_00.00_00347505.tar
‚îî‚îÄ‚îÄ HourlyBackup_Saturday_12:00_PM_February_8_2025_2025-02-08_12.00_00236523.tar
```

## üîß Manuten√ß√£o

### üßπ Limpeza da Base de Dados
```yaml
recorder:
  db_url: !secret mariadb_connection
  auto_purge: false  # Purga manual controlada
```

### üìÅ Organiza√ß√£o de Ficheiros
- **Configura√ß√µes**: Ficheiros YAML separados por dom√≠nio
- **Sensores**: Diret√≥rio `sensors/` com merge autom√°tico
- **Templates**: Diret√≥rio `templates/` modular (ver detalhes abaixo)
- **Scripts**: Ficheiros Python em `pyscript/`
- **UI**: Componentes de interface em `lovelace/`, `popup/`, `button_card_templates/`
- **Blueprints**: Automa√ß√µes reutiliz√°veis em `blueprints/`

### ÔøΩ Sistema de Templates Avan√ßado

O sistema utiliza uma arquitectura modular de templates organizados por funcionalidade:

#### üå°Ô∏è **temperaturas.yaml** - Monitoriza√ß√£o Clim√°tica
Sensores agregados para monitoriza√ß√£o completa da temperatura e humidade da casa:

```yaml
# Temperatura m√©dia de toda a casa
- sensor:
    - name: "Casa Temperatura Media"
      state: >
        {% set cave = states('sensor.bthome_sensor_25e6_temperature') | float %}
        {% set cozinha = states('sensor.bthome_sensor_508c_temperature') | float %}
        # ... agrega√ß√£o de 7 sensores de temperatura
        {{ ((cave + cozinha + quarto_gui + quarto_luisa + sala + sala_superior + suite) / 7) | round(2) }}
```

**Funcionalidades**:
- Agrega√ß√£o de 7 sensores de temperatura distribu√≠dos pela casa
- C√°lculo autom√°tico de humidade relativa m√©dia
- Atributos detalhados por divis√£o
- Sensores BTHome para comunica√ß√£o sem fios

#### ‚ö° **templates_energia_tarifarios.yaml** - Gest√£o Energ√©tica Avan√ßada
Sistema complexo para c√°lculo de tarif√°rios energ√©ticos em tempo real:

```yaml
# Iberdrola - Tarif√°rio Bi-hor√°rio
- sensor:
    - name: "Iberdrola bi-hor√°rio Di√°rio"
      state: >
        {% set vazio = 0.0776 -%}
        {% set fora_vazio = 0.2141 -%}
        {% set IVA = 1.23 -%}
        {% set desconto = 0.881 -%}
        {% set Pre√ßo = vazio if now().hour < 8 or now().hour > 21 else fora_vazio -%}
        {{ ((Pre√ßo * desconto) + IEC) * IVA | round(4) }}
```

**Caracter√≠sticas**:
- **Iberdrola**: Tarif√°rio bi-hor√°rio com descontos para ve√≠culos el√©tricos
- **Coop√©rnico**: Integra√ß√£o com pre√ßos spot OMIE em tempo real
- C√°lculo autom√°tico de impostos (IVA, IEC)
- Pre√ßos diferenciados por hor√°rio (vazio/fora de vazio)

#### üèä **piscina.yaml** - Automa√ß√£o de Piscina Inteligente
Sistema completo de gest√£o da piscina com otimiza√ß√£o energ√©tica:

```yaml
# Tempo restante de filtragem
- sensor:
    - name: "pool_pump_remaining_time"
      state: >-
        {% set time = (((states('input_number.pool_pump_duration_lower_threshold') | float(0))*60 
                      - (states('sensor.bomba_piscina_horas_ligada_diario')|float(-1))*3600)| round | int, 0)|max %}
        {% set hours = ((time % 86400) / 3600) | int %}
        {{ '%02d:%02d'|format(hours, minutes) }}
```

**Funcionalidades**:
- Controlo autom√°tico do tempo de filtragem
- Monitoriza√ß√£o de consumo energ√©tico
- Interface de controlo manual/autom√°tico
- Optimiza√ß√£o baseada em condi√ß√µes meteorol√≥gicas

#### üöó **carregamento_carros.yaml** - Carregamento Inteligente VE
Gest√£o avan√ßada de ve√≠culos el√©tricos com c√°lculo de custos:

```yaml
# Custo de carregamento em tempo real
- sensor:
    - name: "EV Electricity Spend"
      state: >
        {% set price = float(states('sensor.template_iberdrola_bihorario_diario'),0) %}
        {% set meter = float(states('sensor.emoncms_evse_power_kwh'),0) %}
        {% set delta = meter - float(this.attributes.last,0) %}
        {{ '%0.6f'|format( (price) * delta ) }}
```

**Caracter√≠sticas**:
- Monitoriza√ß√£o de m√∫ltiplos ve√≠culos (EV e X1)
- C√°lculo autom√°tico de custos por kWh
- Integra√ß√£o com tarif√°rios din√¢micos
- Tracking de consumo hist√≥rico

#### üå°Ô∏è **cop.yaml** - Bomba de Calor (COP Analysis)
Sistema avan√ßado para an√°lise de efici√™ncia da bomba de calor:

```yaml
# Pot√™ncia t√©rmica em tempo real
- sensor:
    - name: "HPSU.CAN Thermal Power"
      state: >
        {% set flow = states('sensor.hpsu_can_flow_rate') | float(0) %}
        {% set leavingtemp = states('sensor.hpsu_can_flow_temperature_tv') | float(0) %}
        {% set returntemp = states('sensor.hpsu_can_return_temperature_heating') | float(0) %}
        {{ (max(0, (leavingtemp - returntemp) * (4.19 * flow) / 3600) | round(2)) }}
```

**An√°lises Dispon√≠veis**:
- C√°lculo de COP (Coefficient of Performance) em tempo real
- Delta T para aquecimento e AQS (√Åguas Quentes Sanit√°rias)
- Pot√™ncia t√©rmica baseada em fluxo e temperatura
- Monitoriza√ß√£o de efici√™ncia energ√©tica

#### üè† **home_energy.yaml** - Gest√£o Energ√©tica Dom√©stica
Centro de controlo energ√©tico da habita√ß√£o:

```yaml
# Custo de eletricidade consumida
- sensor:
    - name: "Electricity Spend"
      state: >
        {% set price = float(states('sensor.template_iberdrola_bihorario_diario'),0) %}
        {% set meter = float(states('sensor.emoncms_import_kwh'),0) %}
        {{ '%0.6f'|format( (price) * delta ) }}
```

**Monitoriza√ß√£o**:
- Consumo vs. produ√ß√£o solar
- Exporta√ß√£o positiva de energia
- Integra√ß√£o com pre√ßos OMIE
- Balan√ßo energ√©tico em tempo real

#### üî• **bomba_calor.yaml** - Otimiza√ß√£o Hor√°ria
Otimiza√ß√£o autom√°tica baseada em pre√ßos energ√©ticos:

```yaml
# Hora ideal para aquecimento de √°gua
- sensor:
    - name: "Aquecimento Agua Noite"
      state: >
        {% from 'cheapest_energy_hours.jinja' import cheapest_energy_hours %}
        {{ cheapest_energy_hours(
            hours=1, 
            start='22:00', 
            end='08:00'
        ) }}
```

#### üå§Ô∏è **weather.yaml** - Previs√µes Meteorol√≥gicas
Integra√ß√£o com dados meteorol√≥gicos para otimiza√ß√£o:

```yaml
# Cobertura de nuvens para otimiza√ß√£o solar
- sensor:
    - name: "M√©dia de Nuvens Pr√≥ximas 8h"
      state: "{{ states('input_number.average_cloud_cover') }}"
```

#### üó∫Ô∏è **destinos_waze.yaml** - Navega√ß√£o Inteligente
Sistema de navega√ß√£o integrado:

```yaml
# Endere√ßos din√¢micos para Waze
- sensor:
    - name: "Destination address"
      state: >-
         {%- if is_state("input_select.destination", "Farfetch")  -%}
           Centro Empresarial Lionesa, Portugal
         {%- elif is_state("input_select.destination", "Parents")  -%}
           Travessa da Cruz das Almas 10 Vila Real, Portugal
```

### üîÑ Atualiza√ß√µes e Manuten√ß√£o
```bash
# Atualiza√ß√£o via HACS
cd /config/custom_components
git pull origin main  # Para componentes versionados

# Verifica√ß√£o de configura√ß√£o
ha core check

# Backup antes de atualiza√ß√µes maiores
ha backup new --name "pre_update_$(date +%Y%m%d)"

# Rein√≠cio de servi√ßos espec√≠ficos
ha core reload
```

### üìà M√©tricas de Performance
- **Templates Ativos**: 10+ ficheiros modulares
- **Sensores Calculados**: 50+ sensores derivados
- **Atualiza√ß√£o**: Tempo real (trigger-based)
- **Efici√™ncia**: C√°lculos otimizados com cache

## üõ°Ô∏è Seguran√ßa

### üîê Gest√£o de Segredos
```yaml
# secrets.yaml (n√£o inclu√≠do no reposit√≥rio)
mariadb_connection: "mysql://user:pass@host/db"
influxdb_token: "xxxxx-xxxx-xxxx"
telegram_bot_api_key: "bot_token"
```

### üö´ Exclus√µes de Seguran√ßa
- Ficheiro `secrets.yaml` nunca deve ser versionado
- Tokens e passwords em vari√°veis de ambiente
- Logs filtrados para informa√ß√µes sens√≠veis

### üîí Telegram Bot
```yaml
telegram_bot:
  - platform: polling
    api_key: !secret telegram_bot_api_key
    allowed_chat_ids:
      - 5258104860  # ID espec√≠fico do utilizador

notify:
  - platform: telegram
    name: "Gui"
    chat_id: 45258104860
```

## üìû Suporte e Comunidade

### üÜò Resolu√ß√£o de Problemas

#### üîç **Diagn√≥stico R√°pido**
```bash
# Verifica√ß√£o completa do sistema
ha core check --verbose

# Estado dos componentes cr√≠ticos  
ha supervisor info
ha supervisor logs

# Verifica√ß√£o de conectividade
ping 8.8.8.8
curl -I https://api.telegram.org

# Estado da base de dados
mysql -u root -p -e "SHOW PROCESSLIST;"
```

#### üìä **Logs Importantes**
1. **Core**: `home-assistant.log*` - Logs principais do sistema
2. **Supervisor**: `supervisor.log` - Logs do supervisor HA OS
3. **MariaDB**: `/var/log/mysql/error.log` - Erros de BD
4. **Pyscript**: Filtrar por `custom_components.pyscript`
5. **Templates**: Verificar erros de sintaxe YAML

#### ‚ö†Ô∏è **Problemas Comuns e Solu√ß√µes**

**üîå Problema: Templates n√£o atualizam**
```yaml
# Solu√ß√£o: Verificar triggers
- trigger:
    - platform: state
      entity_id: sensor.dependency_sensor
  sensor:
    - name: "My Template Sensor"
      state: "{{ states('sensor.dependency_sensor') | float }}"
```

**üìä Problema: InfluxDB n√£o recebe dados**
```yaml
# Verificar configura√ß√£o
influxdb:
  host: influxdb
  port: 8086
  # Testar conectividade
  # curl -I http://influxdb:8086/ping
```

**üöó Problema: PV Excess Control n√£o funciona**
```python
# Verificar logs pyscript
# Developer Tools > Logs > custom_components.pyscript
# Executar manualmente a automa√ß√£o
# Configuration > Automations > Run
```

**üèä Problema: Piscina n√£o muda de modo**
```yaml
# Verificar input_boolean
input_boolean.modo_automatico: "on/off"
# Verificar automa√ß√µes relacionadas
automation.automacao_bomba_piscina: "active/inactive"
```

#### üîß **Ferramentas de Debug**
```yaml
# Ativar debug espec√≠fico
logger:
  default: info
  logs:
    homeassistant.components.template: debug
    custom_components.pyscript: debug
    homeassistant.helpers.template: debug
```

### üîó Links √öteis e Recursos

#### üìö **Documenta√ß√£o Oficial**
- [Home Assistant Docs](https://home-assistant.io/docs/) - Documenta√ß√£o principal
- [Template Reference](https://home-assistant.io/docs/configuration/templating/) - Refer√™ncia de templates
- [Automation Docs](https://home-assistant.io/docs/automation/) - Automa√ß√µes
- [YAML Guide](https://home-assistant.io/docs/configuration/yaml/) - Guia YAML

#### üõ†Ô∏è **Ferramentas e Extens√µes**
- [HACS](https://hacs.xyz/) - Community Store
- [VSCode Extension](https://marketplace.visualstudio.com/items?itemName=keesschollaart.vscode-home-assistant) - Editor HA
- [Template Editor](https://home-assistant.io/docs/configuration/templating/#template-editor) - Developer Tools
- [YAML Validator](https://codebeautify.org/yaml-validator) - Valida√ß√£o YAML online

#### üèòÔ∏è **Comunidade e Suporte**
- [Community Forum](https://community.home-assistant.io/) - F√≥rum oficial
- [Reddit r/homeassistant](https://reddit.com/r/homeassistant) - Discuss√µes
- [Discord](https://discord.gg/c5DvZ4e) - Chat em tempo real
- [GitHub Issues](https://github.com/home-assistant/core/issues) - Bugs e features

#### ‚ö° **Integra√ß√µes Espec√≠ficas Deste Projeto**
- [PV Excess Control](https://github.com/InventoCasa/ha-advanced-blueprints) - Controlo solar
- [Optimal Humidity](https://github.com/TheRealWaldo/ha-optimal-humidity) - Humidade ideal
- [Pyscript](https://github.com/custom-components/pyscript) - Scripts Python
- [Solcast](https://github.com/oziee/ha-solcast-solar) - Previs√µes solares
- [OMIE](https://github.com/dgomes/ha_omie) - Pre√ßos energ√©ticos
- [Thermal Comfort](https://github.com/dolezsa/thermal_comfort) - Conforto t√©rmico

#### üí∞ **Recursos Energ√©ticos (Portugal)**
- [OMIE Market](https://www.omie.es/pt) - Mercado energ√©tico ib√©rico
- [REN Dados](https://www.ren.pt/pt-PT/dados_de_sistema) - Dados do sistema el√©trico
- [Solcast](https://solcast.com/) - Previs√µes de irradia√ß√£o solar
- [ERSE](https://www.erse.pt/) - Regulador energ√©tico

#### üè† **Dom√≥tica e IoT**
- [Zigbee2MQTT](https://www.zigbee2mqtt.io/) - Bridge Zigbee
- [Tasmota](https://tasmota.github.io/docs/) - Firmware para ESP
- [ESPHome](https://esphome.io/) - Platform para ESP32/ESP8266
- [Node-RED](https://nodered.org/) - Automa√ß√£o visual

### üìß **Contacto e Contribui√ß√µes**

#### ü§ù **Como Contribuir**
1. **Fork** do reposit√≥rio
2. **Clone** para desenvolvimento local
3. **Branch** para nova funcionalidade: `git checkout -b feature/nova-funcionalidade`
4. **Commit** com mensagens descritivas: `git commit -m "Add: Nova funcionalidade X"`
5. **Push** para o branch: `git push origin feature/nova-funcionalidade`
6. **Pull Request** com descri√ß√£o detalhada

#### üìã **Template para Issues**
```markdown
### Descri√ß√£o do Problema
[Descri√ß√£o clara do problema]

### Passos para Reproduzir
1. Ir para...
2. Clicar em...
3. Ver erro...

### Comportamento Esperado
[O que deveria acontecer]

### Comportamento Atual  
[O que est√° a acontecer]

### Logs Relevantes
```yaml
[Colar logs aqui]
```

### Ambiente
- HA Version: [vers√£o]
- OS: [sistema operativo]
- Integra√ß√£o: [qual componente]
```

#### üéØ **Roadmap Futuro**
- [ ] **Integra√ß√£o com Tesla API** para controlo de Powerwall
- [ ] **Machine Learning** para previs√£o de consumo
- [ ] **Integra√ß√£o com Grafana** para dashboards avan√ßados
- [ ] **API REST** para controlo externo
- [ ] **Alexa/Google Assistant** integra√ß√£o completa
- [ ] **Mobile App** personalizada
- [ ] **Kubernetes Deployment** para alta disponibilidade

---

**üè† Este sistema representa uma implementa√ß√£o completa de home automation com foco em efici√™ncia energ√©tica, conforto ambiental e automa√ß√£o inteligente baseada em dados reais e previs√µes.**

**‚ö° Caracter√≠sticas √önicas**:
- ‚úÖ **100% Open Source** - Sem depend√™ncias de cloud propriet√°rio
- ‚úÖ **Efici√™ncia Energ√©tica** - Algoritmos avan√ßados de otimiza√ß√£o solar
- ‚úÖ **Modular** - Componentes independentes e reutiliz√°veis  
- ‚úÖ **Portugu√™s** - Totalmente adaptado ao mercado energ√©tico portugu√™s
- ‚úÖ **Tempo Real** - Dados e controlo em tempo real
- ‚úÖ **Escal√°vel** - Arquitetura preparada para expans√£o

*üìÖ √öltima atualiza√ß√£o da documenta√ß√£o: Julho 2025*  
*üë®‚Äçüíª Mantido por: Guilherme Lima*  
*üìç Localiza√ß√£o: Portugal*

### üìù Notas de Desenvolvimento
- **Vers√£o Base**: Sistema testado com HA 2023.1+
- **Compatibilidade**: Python 3.9+ e 3.10+ 
- **Depend√™ncias Cr√≠ticas**: 
  - `pyscript` para automa√ß√µes avan√ßadas
  - `MariaDB` recomendada para recorder (performance)
  - `InfluxDB v2` para m√©tricas de longo prazo
- **Hardware M√≠nimo**: 
  - 4GB RAM (8GB recomendado)
  - 32GB storage SSD
  - CPU multi-core para processamento de templates
- **Rede**: Largura de banda est√°vel para integra√ß√µes cloud

### üîß Arquitectura T√©cnica Detalhada

#### üìã Stack Tecnol√≥gico
```yaml
# Core System
home_assistant: "2023.1+"
python: "3.10"
operating_system: "Home Assistant OS / Docker"

# Databases
primary_db: "MariaDB 10.x"
metrics_db: "InfluxDB 2.x" 
cache: "Redis (opcional)"

# External Services
weather_api: "OpenWeatherMap + Solcast"
energy_data: "OMIE + ENTSO-E"
notifications: "Telegram Bot API"
backup_storage: "Local + Cloud (opcional)"

# Network
reverse_proxy: "Nginx"
ssl_termination: "Let's Encrypt"
internal_network: "192.168.1.0/24"
```

#### üîÑ Fluxo de Dados
```mermaid
graph TB
    A[Sensores F√≠sicos] --> B[Home Assistant Core]
    B --> C[Templates Engine]
    C --> D[Automations Engine]
    D --> E[Actions/Services]
    B --> F[MariaDB Recorder]
    B --> G[InfluxDB Metrics]
    H[External APIs] --> B
    I[Telegram Bot] <--> B
    J[Mobile Apps] <--> B
```

#### üèóÔ∏è Estrutura de Ficheiros Completa
```
/config/
‚îú‚îÄ‚îÄ üìÑ configuration.yaml          # Configura√ß√£o principal
‚îú‚îÄ‚îÄ üìÑ automations.yaml           # 2500+ linhas de automa√ß√µes
‚îú‚îÄ‚îÄ üìÑ scripts.yaml               # Scripts reutiliz√°veis
‚îú‚îÄ‚îÄ üìÑ scenes.yaml                # Cenas predefinidas
‚îú‚îÄ‚îÄ üìÑ secrets.yaml               # Credenciais (n√£o versionado)
‚îú‚îÄ‚îÄ üìÅ custom_components/         # Integra√ß√µes personalizadas
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ alarmo/               # Sistema de alarmes
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ pyscript/             # Scripts Python
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ solcast_solar/        # Previs√µes solares
‚îÇ   ‚îî‚îÄ‚îÄ ...                      # 20+ componentes
‚îú‚îÄ‚îÄ üìÅ templates/                 # Templates modulares
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ home_energy.yaml      # Gest√£o energ√©tica
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ piscina.yaml          # Controlo piscina
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ carregamento_carros.yaml # VE charging
‚îÇ   ‚îî‚îÄ‚îÄ ...                      # 10+ ficheiros
‚îú‚îÄ‚îÄ üìÅ sensors/                   # Sensores organizados
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ history_stats.yaml    # Estat√≠sticas hist√≥ricas
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ rest.yaml             # Sensores REST API
‚îú‚îÄ‚îÄ üìÅ pyscript/                  # Scripts Python avan√ßados
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ pv_excess_control.py  # Controlo solar principal
‚îú‚îÄ‚îÄ üìÅ blueprints/                # Automa√ß√µes reutiliz√°veis
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ automation/           # Blueprints de automa√ß√£o
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ script/               # Blueprints de scripts
‚îú‚îÄ‚îÄ üìÅ lovelace/                  # Interface de utilizador
‚îú‚îÄ‚îÄ üìÅ www/                       # Ficheiros est√°ticos
‚îú‚îÄ‚îÄ üìÅ backups/                   # Backups autom√°ticos
‚îî‚îÄ‚îÄ üìÅ deps/                      # Depend√™ncias Python
```

#### ‚öôÔ∏è Configura√ß√£o de Desenvolvimento
```yaml
# .devcontainer/configuration.yaml (para desenvolvimento)
logger:
  default: debug
  logs:
    custom_components: debug
    homeassistant.core: info
    
# Configura√ß√£o de teste
recorder:
  db_url: "sqlite:///test.db"
  auto_purge: true
  purge_keep_days: 1

# Hot reload para desenvolvimento
automation: !include automations.yaml
script: !include scripts.yaml
```

### üìä M√©tricas e Monitoriza√ß√£o

#### üéØ KPIs do Sistema
- **Uptime**: 99.8% (Target: 99.9%)
- **Response Time**: <500ms para templates
- **Database Size**: ~2GB MariaDB + ~5GB InfluxDB
- **Backup Success Rate**: 100% (√∫ltimo m√™s)
- **Template Errors**: <0.1% (muito baixo)
- **Automation Execution**: 10,000+ triggers/dia

#### üìà Dashboards Importantes
1. **Energy Management**: Produ√ß√£o vs Consumo solar
2. **System Health**: CPU, Mem√≥ria, Storage
3. **Network Monitoring**: Lat√™ncia, Throughput
4. **Device Status**: Estado de todos os dispositivos
5. **Cost Analysis**: Gastos energ√©ticos em tempo real

### üîÑ Procedimentos de Manuten√ß√£o

#### üóìÔ∏è Manuten√ß√£o Regular
```bash
# Di√°rio (automatizado)
ha core reload                    # Reload configura√ß√£o
ha supervisor repair              # Verifica√ß√£o de integridade
automated_backup.sh               # Backup autom√°tico

# Semanal
ha core check                     # Verifica√ß√£o configura√ß√£o
ha supervisor update              # Atualiza√ß√µes dispon√≠veis
cleanup_logs.sh                   # Limpeza de logs antigos

# Mensal  
database_maintenance.sql          # Otimiza√ß√£o BD
ha addons update                  # Atualiza√ß√£o add-ons
security_audit.sh                 # Auditoria de seguran√ßa
```

#### üÜò Procedimentos de Emerg√™ncia
```bash
# Restauro de backup
ha backup restore backup_name.tar

# Modo de recupera√ß√£o
ha core restart --safe-mode

# Limpeza de cache
rm -rf /config/.storage/core.*
ha core restart

# Verifica√ß√£o de integridade
ha core check --verbose
```

### üß™ Ambiente de Teste

#### üî¨ Setup de Desenvolvimento
```yaml
# docker-compose.test.yml
version: '3.8'
services:
  homeassistant-test:
    image: homeassistant/home-assistant:latest
    volumes:
      - ./test-config:/config
    environment:
      - TZ=Europe/Lisbon
    ports:
      - "8124:8123"
    
  mariadb-test:
    image: mariadb:10.6
    environment:
      MYSQL_ROOT_PASSWORD: test
      MYSQL_DATABASE: homeassistant_test
```

#### ‚úÖ Testes Automatizados
```python
# tests/test_templates.py
import pytest
from homeassistant.core import HomeAssistant

def test_energy_calculation_template():
    """Test energy cost calculation template."""
    # Implementa√ß√£o de testes unit√°rios
    pass

def test_pool_automation_logic():
    """Test pool automation decision logic.""" 
    # Testes de l√≥gica de automa√ß√£o
    pass
```

---

**üí° Dicas de Performance**:
- Use `trigger-based templates` em vez de `time_pattern` quando poss√≠vel
- Agrupe sensores similares em ficheiros de template √∫nicos  
- Configure `recorder` include/exclude para otimizar BD
- Use `device_class` e `state_class` corretos para m√©tricas
- Implemente `unique_id` em todos os sensores para estabilidade

---

**üè† Este sistema representa uma implementa√ß√£o completa de home automation com foco em efici√™ncia energ√©tica, conforto ambiental e automa√ß√£o inteligente.**

*√öltima atualiza√ß√£o da documenta√ß√£o: Julho 2025*
